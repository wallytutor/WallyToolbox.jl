<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Empirical fuel manipulation · WallyToolbox.jl</title><meta name="title" content="Empirical fuel manipulation · WallyToolbox.jl"/><meta property="og:title" content="Empirical fuel manipulation · WallyToolbox.jl"/><meta property="twitter:title" content="Empirical fuel manipulation · WallyToolbox.jl"/><meta name="description" content="Documentation for WallyToolbox.jl."/><meta property="og:description" content="Documentation for WallyToolbox.jl."/><meta property="twitter:description" content="Documentation for WallyToolbox.jl."/><meta property="og:url" content="https://wallytutor.github.io/WallyToolbox.jl/WallyToolbox/Tutorials/empirical-fuel/"/><meta property="twitter:url" content="https://wallytutor.github.io/WallyToolbox.jl/WallyToolbox/Tutorials/empirical-fuel/"/><link rel="canonical" href="https://wallytutor.github.io/WallyToolbox.jl/WallyToolbox/Tutorials/empirical-fuel/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">WallyToolbox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">WallyToolbox</span><ul><li><a class="tocitem" href="../../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-1-2" type="checkbox"/><label class="tocitem" for="menuitem-1-2"><span class="docs-label">WallyToolbox</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../setup-guide/">Setup guide</a></li><li><a class="tocitem" href="../../thermochemistry/">Thermochemistry</a></li><li><a class="tocitem" href="../../transport/">Transport</a></li><li><a class="tocitem" href="../../flowsheet/">Flowsheet</a></li><li><a class="tocitem" href="../../constants/">Constants</a></li><li><a class="tocitem" href="../../utilities/">Utilities</a></li><li><a class="tocitem" href="../../roadmap/">Roadmap</a></li><li><a class="tocitem" href="../../../Modules/RadCalNet/">RadCalNet</a></li><li><a class="tocitem" href="../../../Modules/Cantera/">Cantera</a></li><li><a class="tocitem" href="../../../Modules/OpenFOAM/">OpenFOAM</a></li><li><input class="collapse-toggle" id="menuitem-1-2-11" type="checkbox"/><label class="tocitem" for="menuitem-1-2-11"><span class="docs-label">Internals</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Internals/Documents/">Documents</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-1-3" type="checkbox"/><label class="tocitem" for="menuitem-1-3"><span class="docs-label">Software</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Software/Elmer/">Elmer Multiphysics</a></li><li><a class="tocitem" href="../../../Software/OpenFOAM11/">OpenFOAM 11</a></li><li><a class="tocitem" href="../../../Software/Basilisk/">Basilisk</a></li><li><a class="tocitem" href="../../../Software/LAMMPS/">LAMMPS</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-1-4" type="checkbox"/><label class="tocitem" for="menuitem-1-4"><span class="docs-label">Computing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Computing/01-Scientific-Computing/">Scientific Computing</a></li><li><a class="tocitem" href="../../../Computing/02-General-Computing-Skills/">General computing skills</a></li><li><a class="tocitem" href="../../../Computing/03-Programming-Languages/">Programming</a></li><li><a class="tocitem" href="../../../Computing/04-Geometry-and-Preprocessing/">Geometry and Preprocessing</a></li><li><a class="tocitem" href="../../../Computing/05-Postprocessing/">Postprocessing</a></li><li><a class="tocitem" href="../../../Computing/06-Domain-Specific-Software/">Domain specific software</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-1-5" type="checkbox"/><label class="tocitem" for="menuitem-1-5"><span class="docs-label">Science</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Science/01-Continuum-Mechanics/">Continuum Mechanics</a></li><li><a class="tocitem" href="../../../Science/03-Machine-Learning/">Machine Learning</a></li><li><a class="tocitem" href="../../../Science/08-Porous-Solids/">Porous solids</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-1-6" type="checkbox"/><label class="tocitem" for="menuitem-1-6"><span class="docs-label">Notebooks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Notebooks/01-Composite-Conduction/">Steady-state heat transfer</a></li><li><a class="tocitem" href="../../../Notebooks/02-Part-Radiation-Heating/">Transient heat transfer</a></li><li><a class="tocitem" href="../../../Notebooks/03-Plug-Flow-Reactor-1/">Reator pistão</a></li><li><a class="tocitem" href="../../../Notebooks/07-Air-Properties/">Fitting air properties</a></li><li><a class="tocitem" href="../../../Notebooks/08-Kramers-Model-Validation/">Kramers&#39; model</a></li><li><a class="tocitem" href="../../../Notebooks/A1-Julia-para-Cientistas/">Julia para Cientistas</a></li><li><a class="tocitem" href="../../../Notebooks/A2-Ciencia-Colaborativa-e-Julia/">Ciência colaborativa e Julia</a></li></ul></li><li><a class="tocitem" href="../../../References/">References</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Empirical fuel manipulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Empirical fuel manipulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/wallytutor/WallyToolbox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/wallytutor/WallyToolbox.jl/blob/main/docs/src/WallyToolbox/Tutorials/empirical-fuel.md" title="View source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Empirical-fuel-manipulation"><a class="docs-heading-anchor" href="#Empirical-fuel-manipulation">Empirical fuel manipulation</a><a id="Empirical-fuel-manipulation-1"></a><a class="docs-heading-anchor-permalink" href="#Empirical-fuel-manipulation" title="Permalink"></a></h1><h2 id="Computing-an-equivalent-species"><a class="docs-heading-anchor" href="#Computing-an-equivalent-species">Computing an equivalent species</a><a id="Computing-an-equivalent-species-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-an-equivalent-species" title="Permalink"></a></h2><p>In this tutorial we discuss an approach to <em>unify</em> species in a chemical system for simplified representation in CFD simulations; a typical use case would be simulating a system where energy aspects are more important than actual kinetics features and a major combusting species is present.</p><p>We start by importing the required tools:</p><pre><code class="language-julia hljs">using WallyToolbox
using PyCanteraTools
using PythonCall

const ct = pyimport(&quot;cantera&quot;)</code></pre><p>In what follows let&#39;s assume that the molar composition of the reference fuel is given by the following composition string (in Cantera format). This is a typical natural gas composition where we find methane as major species, other minor hydrocarbons, and residual inert species.</p><pre><code class="language-julia hljs">X = &quot;CH4: 0.9194, C2H6: 0.0302, C3H8: 0.0059, CO2: 0.0078, N2: 0.0367&quot;</code></pre><p>Assume we want to get a single <em>equivalent</em> hydrocarbon representing all those details in fuel composition; other species remain as they are. For this we can filter the selected species from the provided composition string with functionalities exported by <code>PyCanteraTools</code>.</p><pre><code class="language-julia hljs">hydrocarbons = [&quot;CH4&quot;, &quot;C2H6&quot;, &quot;C3H8&quot;]

ishydrocarbon(x) = x[1] in hydrocarbons

X_dict = filter(ishydrocarbon, cantera_string_to_dict(X))

X_hydr = cantera_dict_to_string(X_dict)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;C3H8: 0.005900000000, CH4: 0.919400000000, C2H6: 0.030200000000&quot;</code></pre><p>Next we load a solution with the reference mechanism and set the gas composition to the filtered (relative molar fractions) composition.</p><pre><code class="language-julia hljs">gas = ct.Solution(&quot;gri30.yaml&quot;)
gas.TPX = nothing, nothing, X_hydr</code></pre><p>The elemental mass fractions of <em>CHONS</em> can be recoved from Cantera using the wrapper function <code>chons_get_fractions</code>.</p><pre><code class="language-julia hljs">Y = chons_get_fractions(gas; basis = :mass)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{Float64}:
 0.7526577798064804
 0.2473422201935198
 0.0
 0.0
 0.0</code></pre><p>For preserving the flow characteristics of the simplified fuel, it is important to ensure the new <em>artificial</em> composition preserves the mean molecular mass. Doing so will keep constant inlet flow rate if using mass flow boundary conditions, as it is usual in combustion simulations.</p><pre><code class="language-julia hljs">mw = pyconvert(Float64, gas.mean_molecular_weight)
mw</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">16.659571428571425</code></pre><p>Below we compute the stoichiometric coefficient of carbon in the target <em>artificial</em> species; it is simply a mass to mole fraction conversion, as one might promptly recognize.</p><pre><code class="language-julia hljs">scaler = :C =&gt; Y[1]*mw/1000atomicmass(:C)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">:C =&gt; 1.043956043956044</code></pre><p>Using the mass fractions and the scaler one can easily compute the new hypothetical species using <code>hfo_empirical_formula</code>. It must be emphasized that although this function was initially conceived for handling heavy-fuel oils (HFOs) it is can also be used for any species in the <em>CHONS</em> chemistry family.</p><pre><code class="language-julia hljs">empirical_fuel = hfo_empirical_formula(Y; scaler)

String(empirical_fuel)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;C(1.043956)H(4.087912)O(0.000000)N(0.000000)S(0.000000)&quot;</code></pre><p>To wrap-up we verify that the new species really matches the target molecular mass; because of round-off errors and possible differences in atomic masses between Cantera and our database <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>.</p><pre><code class="language-julia hljs">1000ChemicalCompound(Dict(zip(&quot;CHONS&quot;, empirical_fuel.X))).M ≈ mw</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>There are a few extra steps that one must be aware; with the newly created species we need to create (by some means not described here) a new mechanism containing the hypothetical species. Once that is done, one needs to compute the heating values related to that fuel, <em>e.g.</em> using <code>mixture_heating_value</code>, what will lead to unphysical values at first. The formation enthalpy of the referred species needs to be corrected in mechanism data (generally NASA7 polynomials, for which it is done in the fifth coefficient) to match the reference fuel energy release.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>There should not be any difference because the database used internally by WallyToolbox is an extraction of Cantera source code.</li></ul></section></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 13 August 2024 19:55">Tuesday 13 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
