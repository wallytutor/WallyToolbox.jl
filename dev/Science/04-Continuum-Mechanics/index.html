<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Continuum Mechanics · WallyToolbox.jl</title><meta name="title" content="Continuum Mechanics · WallyToolbox.jl"/><meta property="og:title" content="Continuum Mechanics · WallyToolbox.jl"/><meta property="twitter:title" content="Continuum Mechanics · WallyToolbox.jl"/><meta name="description" content="Documentation for WallyToolbox.jl."/><meta property="og:description" content="Documentation for WallyToolbox.jl."/><meta property="twitter:description" content="Documentation for WallyToolbox.jl."/><meta property="og:url" content="https://wallytutor.github.io/WallyToolbox.jl/Science/04-Continuum-Mechanics/"/><meta property="twitter:url" content="https://wallytutor.github.io/WallyToolbox.jl/Science/04-Continuum-Mechanics/"/><link rel="canonical" href="https://wallytutor.github.io/WallyToolbox.jl/Science/04-Continuum-Mechanics/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">WallyToolbox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">WallyToolbox</span><ul><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-1-2" type="checkbox"/><label class="tocitem" for="menuitem-1-2"><span class="docs-label">Julia Modules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Modules/DryCombustion/">DryCombustion</a></li><li><a class="tocitem" href="../../Modules/DryFlowsheet/">DryFlowsheet</a></li><li><a class="tocitem" href="../../Modules/DryGranular/">DryGranular</a></li><li><a class="tocitem" href="../../Modules/DryMaterials/">DryMaterials</a></li><li><a class="tocitem" href="../../Modules/DryTransport/">DryTransport</a></li><li><a class="tocitem" href="../../Modules/RadCalNet/">RadCalNet</a></li><li><a class="tocitem" href="../../Modules/Cantera/">Cantera</a></li><li><a class="tocitem" href="../../Modules/OpenFOAM/">OpenFOAM</a></li><li><a class="tocitem" href="../../Modules/helpers/">Helpers</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-1-3" type="checkbox"/><label class="tocitem" for="menuitem-1-3"><span class="docs-label">Computing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Computing/01-Scientific-Computing/">Scientific Computing</a></li><li><a class="tocitem" href="../../Computing/02-General-Computing-Skills/">General computing skills</a></li><li><a class="tocitem" href="../../Computing/03-Programming-Languages/">Programming</a></li><li><a class="tocitem" href="../../Computing/04-Geometry-and-Preprocessing/">Geometry and Preprocessing</a></li><li><a class="tocitem" href="../../Computing/05-Postprocessing/">Postprocessing</a></li><li><a class="tocitem" href="../../Computing/06-Domain-Specific-Software/">Domain specific software</a></li><li><a class="tocitem" href="../../Computing/Elmer/">Elmer Multiphysics</a></li><li><a class="tocitem" href="../../Computing/OpenFOAM11/">OpenFOAM 11</a></li><li><a class="tocitem" href="../../Computing/Basilisk/">Basilisk</a></li><li><a class="tocitem" href="../../Computing/LAMMPS/">LAMMPS</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-1-4" type="checkbox" checked/><label class="tocitem" for="menuitem-1-4"><span class="docs-label">Science</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../01-Theoretical-Physics/">Theoretical Physics</a></li><li><a class="tocitem" href="../02-Density-Functional-Theory/">Density Functional Theory (DFT)</a></li><li><a class="tocitem" href="../03-Molecular-Dynamics/">Molecular Dynamics (MD)</a></li><li class="is-active"><a class="tocitem" href>Continuum Mechanics</a><ul class="internal"><li><a class="tocitem" href="#Analysis-of-transport-phenomena"><span>Analysis of transport phenomena</span></a></li><li><a class="tocitem" href="#Mass-and-energy-transfer"><span>Mass and energy transfer</span></a></li><li><a class="tocitem" href="#Fluid-mechanics"><span>Fluid mechanics</span></a></li></ul></li><li><a class="tocitem" href="../05-Machine-Learning/">Machine Learning</a></li><li><a class="tocitem" href="../06-Dimensionless-groups/">Dimensionless groups</a></li><li><a class="tocitem" href="../07-Finite-Volume-Method/">Finite Volume Method</a></li><li><a class="tocitem" href="../08-Conductivity-Porous-Solids/">Thermal conductivity of porous solids</a></li><li><a class="tocitem" href="../09-Finite-Element-Method/">Finite Element Method</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-1-5" type="checkbox"/><label class="tocitem" for="menuitem-1-5"><span class="docs-label">Notebooks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Notebooks/01-Composite-Conduction/">Steady-state heat transfer</a></li><li><a class="tocitem" href="../../Notebooks/02-Part-Radiation-Heating/">Transient heat transfer</a></li><li><a class="tocitem" href="../../Notebooks/A1-Julia-para-Cientistas/">Julia para Cientistas</a></li></ul></li><li><a class="tocitem" href="../../References/">References</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">WallyToolbox</a></li><li><a class="is-disabled">Science</a></li><li class="is-active"><a href>Continuum Mechanics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Continuum Mechanics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/wallytutor/WallyToolbox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/wallytutor/WallyToolbox.jl/blob/main/docs/tmp/Science/04-Continuum-Mechanics.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Continuum-Mechanics"><a class="docs-heading-anchor" href="#Continuum-Mechanics">Continuum Mechanics</a><a id="Continuum-Mechanics-1"></a><a class="docs-heading-anchor-permalink" href="#Continuum-Mechanics" title="Permalink"></a></h1><hr/><h2 id="Analysis-of-transport-phenomena"><a class="docs-heading-anchor" href="#Analysis-of-transport-phenomena">Analysis of transport phenomena</a><a id="Analysis-of-transport-phenomena-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis-of-transport-phenomena" title="Permalink"></a></h2><p>Theses notes intend to provide in a very concise way overview of the mathematical fundamentals of transport phenomena. In this sense, they are devoted to generalities rather than specific closure models. You can even see them as a cheat-sheet or simple lecture notes. </p><p>In that sense, they try to be straightforward and mostly self-contained in the fundamental topics, with increased reference to external sources in applied subjects. They were first redacted based on the MITx series <a href="https://mitxonline.mit.edu/courses/course-v1:MITxT+10.50.CH01x/">Analysis of Transport Phenomena by Pr. Dr. Martin Bazant</a> and further extended based on several sources cited along the way. </p><p>The main goal is to provide a general approach of transport phenomena applied to Materials Science and Process Engineering, but readers of other fields might also be interested in parts of the contents.</p><p><em>Note:</em> this is still a work in progress and quickly evolving. Please <a href="mailto:walter.dalmazsilva.manager@gmail.com">let me know</a> if you found any typos or conceptual mistakes. I am still to ask some friends to review them.</p><h3 id="Transport-phenomena-foundations"><a class="docs-heading-anchor" href="#Transport-phenomena-foundations">Transport phenomena foundations</a><a id="Transport-phenomena-foundations-1"></a><a class="docs-heading-anchor-permalink" href="#Transport-phenomena-foundations" title="Permalink"></a></h3><p>Most physical phenomena are actually discrete processes (particles); many phenomena such as heat transfer are actual discrete vibrations in materials. Such systems are described by large systems of coupled ordinary differential equations (ODE&#39;s) which quickly become intractable and require numerical solution. Continuum approximations, <em>i.e.</em> an averaging process over a representative volume element (RVE), are used to generate a <em>single</em> partial differential equation (PDE) from <em>many</em> such ODE&#39;s. This transformation leads to the concept of <em>conservation equations</em>.</p><p>Say we have a quantity <span>$b$</span> such as it represents a number <span>$\#$</span> concentration of a given physical quantity. Associated to this quantity we have a flux density <span>$\vec{F}$</span> through the boundaries of the system and a rate production in volume <span>$B_v$</span> as summarized in the following table.</p><p class="math-container">\[\begin{align}
b &amp;= \dfrac{\#}{\text{volume}}                 &amp;\qquad\text{concentration}  \\
\vec{F} &amp;= \dfrac{\#}{\text{area}\cdotp{}\text{time}} &amp;\qquad\text{flux density}   \\
B_{v} &amp;= \dfrac{\#}{\text{volume}\cdotp{}\text{time}} &amp;\qquad\text{production rate}
\end{align}\]</p><h3 id="General-conservation-equation"><a class="docs-heading-anchor" href="#General-conservation-equation">General conservation equation</a><a id="General-conservation-equation-1"></a><a class="docs-heading-anchor-permalink" href="#General-conservation-equation" title="Permalink"></a></h3><p>The most general statement of conservation of this quantity <span>$b$</span> writes then:</p><p class="math-container">\[\frac{d}{dt}\left(\int_{V}bdV\right) = -\int_{\Omega}\vec{n}\cdotp\vec{F}dA+\int_{V}B_{v}dV\]</p><p>Using divergence theorem this can be converted into:</p><p class="math-container">\[\frac{d}{dt}\left(\int_{V}bdV\right) = -\int_{V}\nabla\cdotp{\vec{F}}dV+\int_{V}B_{v}dV\]</p><p>Assuming an Eulerian reference frame (fixed) to the volume <span>$V$</span> we can move the time derivative of the above expression inside the left-hand side integral. Rearranging we have</p><p class="math-container">\[\int_{V}\left(\frac{\partial{}b}{\partial{}t} + \nabla\cdotp{\vec{F}} - B_{v}\right)dV = 0\]</p><p>For a differential volume <span>$dV$</span> the integrand must be identically zero, from which the PDE arise:</p><p class="math-container">\[\frac{\partial{}b}{\partial{}t} + \nabla\cdotp{\vec{F}} - B_{v} = 0\]</p><h3 id="Conservation-at-system-boundaries"><a class="docs-heading-anchor" href="#Conservation-at-system-boundaries">Conservation at system boundaries</a><a id="Conservation-at-system-boundaries-1"></a><a class="docs-heading-anchor-permalink" href="#Conservation-at-system-boundaries" title="Permalink"></a></h3><p>So far we have a PDE describing the conservation <em>inside</em> the RVE of the system being described. To be able to solve such a system we also need to provide a description of its interactions with its surroundings through the specification of <em>boundary conditions</em>.</p><p>Assume a volume of thickness <span>$l$</span> enclosing a boundary <span>$S$</span> splitting domains <span>$V_{1}$</span> and <span>$V_{2}$</span>, where discontinuities in properties and all quantities describing the system may be present. We can write the continuity equation for this <em>thick</em> boundary as</p><p class="math-container">\[\frac{d}{dt}\left(\int_{V}bdV\right) = -\int_{\Omega}\vec{n}\cdotp\vec{F}dA+\int_{V}B_{v}dV+\int_{\Omega}B_{s}dA\]</p><p>where the last term has been added to describe the net surface production rate of <span>$b$</span>. Collapsing the volume over the boundary <span>$S$</span> by taking the limit where <span>$l\to{}0$</span>, it should be evident that all volume integrals in the above vanish. The integral form of boundary condition then simplifies to</p><p class="math-container">\[\int_{\Omega}\vec{n}\cdotp\vec{F}dA=\int_{\Omega}B_{s}dA\]</p><p>Defining as positive the normal of <span>$S$</span> pointing outwards <span>$V_{1}$</span> the integrant on right-hand side can be written as <span>$\vec{n}\left(\vec{F}_{2}-\vec{F}_{1}\right)$</span>. Applying mean value theorem as if all terms where in the same side of the equation (that vanishes overall) leads to the differential form of boundary condition</p><p class="math-container">\[\vec{n}\left(\vec{F}_{2}-\vec{F}_{1}\right)=B_{s}\]</p><p>This expression has a very straightforward interpretation. If there is no creation rate <span>$B_{s}$</span> at the interface, flux is continuous across interface; otherwise some arbitrary form of discontinuity should arise, whose form would depend on the volume governing equations at each side of <span>$S$</span>.</p><blockquote><p>[!todo] The following is something I need to abstract better, although I fully understand the mathematical origins. The argument that it is formulated in the interface reference frame but viewed from the observer frame bothers me.</p></blockquote><p>In the case of moving interfaces, the previous formulation needs to account for the relative motion of the boundary and the associated fictitious fluxes that follow it. In the interface reference frame, a relative flux <span>$b_{i}\vec{v}_{s}$</span> needs to be accounted for, resulting in the modified boundary condition</p><p class="math-container">\[\vec{n}\left(\vec{F}_{2}-b_{2}\vec{v}_{s}\right)-\vec{n}\left(\vec{F}_{1}-b_{1}\vec{v}_{s}\right)=B_{s}\]</p><p>From this condition it arrises that the magnitude of the normal component of the interface velocity is constrained to the following expression. No matter what physics is governing the movement, this compatibility constraint must be verified.</p><p class="math-container">\[v_{s} = \frac{\vec{n}\left(\vec{F}_{2}-\vec{F}_{1}\right)-B_{s}}{b_{2}-b_{1}}\]</p><blockquote><p>[!todo] In the growing and shrinking bubble example, Pr. Bazant comes up with a variant of this expression where the fluxes are given by <span>$\rho{}v$</span>, but I cannot realize how can the velocity <span>$v_{1}\neq{}v_{2}\neq{}v_{s}$</span> in this case.</p></blockquote><hr/><h2 id="Mass-and-energy-transfer"><a class="docs-heading-anchor" href="#Mass-and-energy-transfer">Mass and energy transfer</a><a id="Mass-and-energy-transfer-1"></a><a class="docs-heading-anchor-permalink" href="#Mass-and-energy-transfer" title="Permalink"></a></h2><h3 id="Derivation-of-conservation-equations"><a class="docs-heading-anchor" href="#Derivation-of-conservation-equations">Derivation of conservation equations</a><a id="Derivation-of-conservation-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Derivation-of-conservation-equations" title="Permalink"></a></h3><p>In the nineteenth century, Fick demonstrated <em>empirically</em> that the flux density of a species submitted to gradient field responded linearly to its concentration <span>$c$</span> gradient. Notice here <span>$c$</span> takes the place of the more general <span>$b$</span> in the conservation form derivation. In the more general case we should use subindexes for species concentrations and diffusivities, but that will be neglected here.</p><p class="math-container">\[\vec{F}\propto{}-\nabla{}c\]</p><p>This is actually the simplest form of diffusion modeling and, in general, is valid only in very specific cases, <em>i.e.</em> when a single species is being transported in a system without the effect of other components. Introducing a proportionality coefficient <span>$D$</span>, the diffusivity, we have:</p><p class="math-container">\[\vec{F}=-D\nabla{}c\]</p><p>Using this expression in our conservation equation leads to:</p><p class="math-container">\[\frac{\partial{}c}{\partial{}t} - \nabla\cdotp{\left(D\nabla{}c\right)} - R_{v} = 0\]</p><p>Under the very specific case where there is no volumetric production rate <span>$R_{v}$</span>, <em>i.e.</em> no chemical reactions, and constant diffusivity <span>$D$</span>, <em>i.e.</em> no composition or space dependence, this simplifies to the well-studied form of the so called Fick&#39;s second law:</p><p class="math-container">\[\frac{\partial{}c}{\partial{}t} = D\nabla^{2}{c}\]</p><p>This expression happens to be isomorph with heat diffusion equation for a constant specific heat medium because Fourier&#39;s law is analogous to Fick&#39;s first law, leading to the same final mathematical form. Using the thermodynamic definition <span>$dh=\rho{}c_{p}dT$</span> we have</p><p class="math-container">\[\frac{\partial{}T}{\partial{}t} = \frac{k}{\rho{}c_{p}}\nabla^{2}{T}\]</p><p>It must be noticed that in the general case, the quantity being transported in heat equation is the enthalpy density <span>$h$</span> and the potential field is linearized in terms of temperature <span>$T$</span> through Fourier&#39;s equation. Without the constant specific heat simplification and with variable thermal conductivity <span>$k$</span> it is stated as:</p><p class="math-container">\[\frac{\partial{}h}{\partial{}t} = \nabla\cdotp\left(k\nabla{T}\right)\]</p><p>Other than for very simple enthalpy-specific heat relationships (such as the constant approximation discussed above), this PDE must be solved numerically with a coupled system of nonlinear equations for computing the field of temperatures in terms of enthalpies. In the above we neglect the volumetric heat production rate, which would be present, <em>e.g.</em> in a reacting system or a material undergoing nuclear fission.</p><h3 id="Formulation-of-boundary-conditions"><a class="docs-heading-anchor" href="#Formulation-of-boundary-conditions">Formulation of boundary conditions</a><a id="Formulation-of-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Formulation-of-boundary-conditions" title="Permalink"></a></h3><p>When dealing with mass and heat transfer in the absence of more <em>exotic</em> physics such as electromagnetic effects, a pair of possible descriptions for the boundary fluxes arise; the first must be provided as a closure model for the surface species production rates <span>$R_{s}$</span> for mass transfer, and heat generation rate <span>$q_{s}$</span> for heat transfer; the other possibility is to assume the medium outside of the modeled domain is a <em>reservoir</em> with constant <span>$b_{\infty}$</span>, the the proper <span>$b$</span> depending on the phenomena being described. The latter is generally modeled through a constitutive law under the form <span>$\vec{F}=h\left(b-b_{\infty}\right)$</span>, where <span>$h$</span> is introduced as a transfer coefficient.</p><p class="math-container">\[-\vec{n}\cdotp{}D\nabla{}c=
\begin{cases}
R_{s}\\[6pt]
h_{m}(c-c_{\infty})
\end{cases}
\qquad\text{and}\qquad
-\vec{n}\cdotp{}k\nabla{}T=
\begin{cases}
q_{s}\\[6pt]
h_{e}(T-T_{\infty})
\end{cases}\]</p><p>The actual meaning of <span>$h$</span>, be for mass transfer <span>$h_{m}$</span> or energy <span>$h_{e}$</span> depends of the physics being approximated in the external reservoir. There are specific, generally (semi-)empirical methods for evaluating reasonable values for the analysis of their values; this will be the subject of a future topic because the current context is still focused in general principles.</p><p>As a side note, it is worth mentioning here that in analytical methods the <span>$b_{\infty}$</span> is treated as constant because otherwise analysis could grow exponentially in complexity. For the numerical solution of models it can be often treated as an explicit time function. For instance, imagine a material treatment where pulses of a reacting species are controlled and their concentration in the reactor is known in time; if modeling the solid state uncoupled from the reactor - what is generally the case due to computational time limitations - then the value of <span>$b_{\infty}$</span> can be provided explicitly, keeping in mind that <span>$h$</span> can also be a function of this value or surface concentration, depending on the closure model used for the specific simulation.</p><h3 id="Microscopic-models-of-diffusion"><a class="docs-heading-anchor" href="#Microscopic-models-of-diffusion">Microscopic models of diffusion</a><a id="Microscopic-models-of-diffusion-1"></a><a class="docs-heading-anchor-permalink" href="#Microscopic-models-of-diffusion" title="Permalink"></a></h3><p>The models discussed so far are in fact the macroscopic response to discrete phenomena happening at the atomic and molecular scales. Particles moving randomly due to thermal energy in a fluid or solid follow a path described by a probability density function in steps that in most cases happen at a typical rate due to these thermal fluctuations.</p><h4 id="Diluted-mixtures"><a class="docs-heading-anchor" href="#Diluted-mixtures">Diluted mixtures</a><a id="Diluted-mixtures-1"></a><a class="docs-heading-anchor-permalink" href="#Diluted-mixtures" title="Permalink"></a></h4><p>In the most simple of cases, a <em>non-interacting particle</em> in a dilute mixture performs a <em>random walk</em>; when many such particles are present in one part of the domain, as we will show later, the resulting gradient of concentration that will be established over a sufficiently large amount of time leads to Fick&#39;s law. The terminology was created by <a href="https://www.nature.com/articles/072294b0">Pearson (1905)</a> for which <a href="https://www.nature.com/articles/072318a0">Rayleigh (1905)</a> had already found a solution many years beforehand; is also appears in the solution of Brownian motion by <a href="https://myweb.rz.uni-augsburg.de/~eckern/adp/history/einstein-papers/1905_17_549-560.pdf">Einstein (1905)</a> (translated <a href="https://www.damtp.cam.ac.uk/user/gold/pdfs/teaching/old_literature/Einstein1905.pdf">here</a>) and turbulent diffusion by <a href="https://courses.washington.edu/mengr537/Lecture_Notes/DiffusionContinuousMovements_TaylorDispersion_ProcMathSocLon1921.pdf">Taylor (1922)</a>.</p><p>In the derivation of diffusion equation, following the already mentioned <em>non-interacting particles</em> hypothesis, one also needs steps to be <em>independent, identically distributed</em> (IDD) and limited by a <em>finite variance</em> <span>$\sigma^{2}$</span>, <em>i.e.</em> <span>$p(x\pm{}K\sigma)\to{}0$</span> quickly for some finite <span>$K$</span>.</p><p class="math-container">\[P_{N+1}(x) = \int{}P_{N}(x-y)p(y)dy = (P_{N} \ast p)(x)\]</p><blockquote><p><em>The probability <span>$P_{N+1}(x)$</span> that a particle is found at <span>$x$</span> at step <span>$N+1$</span> is equal to the sum of the probabilities <span>$p(y)$</span> of particles at a distance <span>$y$</span> from <span>$x$</span> execute a movement of such amplitude to reach <span>$x$</span> times the probability of a particle being at the position <span>$P_{N}(x-y)$</span>.</em></p></blockquote><p class="math-container">\[P_{N} = (P_{0} \ast p \ast p \ast \dots p)(x) = (P_{0} \ast p^{\ast{}N})(x)\]</p><p class="math-container">\[\begin{align}
P_{N+1}(x)
&amp;= \int{}\left(P_{N}(x) - yP_{N}^{\prime}(x) + \dfrac{1}{2}y^{2}P_{N}^{\prime\prime}(x)\right)p(y)dy\\
%
&amp;=P_{N}(x)\int{}p(y)dy - P_{N}^{\prime}(x)\int{}yp(y)dy + \dfrac{1}{2}P_{N}^{\prime\prime}(x)\int{}y^{2}p(y)dy\\
%
&amp;=P_{N}(x) - \langle{}y\rangle{}P_{N}^{\prime}(x) + \dfrac{1}{2}\langle{}y^{2}\rangle{}P_{N}^{\prime\prime}(x)
\end{align}\]</p><p>The fourth and last requirement now is that process take place with a <em>finite mean step <span>$\langle\tau\rangle$</span></em>:</p><p class="math-container">\[\dfrac{P_{N+1}(x) - P_{N}(x)}{\langle\tau\rangle} + \dfrac{\langle{}y\rangle{}}{\langle\tau\rangle}P_{N}^{\prime}(x) = \dfrac{\langle{}y^{2}\rangle{}}{2\langle\tau\rangle}P_{N}^{\prime\prime}(x)\]</p><p>Introducing <span>$c(x-vt,t)\sim{}P_{N}(x-vt)$</span> with <span>$t=N\langle\tau\rangle$</span></p><blockquote><p>[!todo] Finish the additional Taylor expansion from the above expression to get formally to the final result provided below.</p></blockquote><p class="math-container">\[\dfrac{\partial{}c}{\partial{}t} + v\dfrac{\partial{}c}{\partial{}x} = D\dfrac{\partial^{2}c}{\partial{}x^{2}}
%
\quad\text{where}\quad{}v=\dfrac{\langle{}y\rangle}{\langle\tau\rangle}
%
\quad\text{and}\quad{}D=\dfrac{\langle{}y^{2}\rangle-\langle{}y\rangle^{2}}{2\langle\tau\rangle}\]</p><blockquote><p>[!info] More about this in chapter 4 of <a href="../../References/@Mehrer2007/">Mehrer2007</a> [<a href="../../References/#Mehrer2007">19</a>].</p></blockquote><h4 id="Concentrated-mixtures"><a class="docs-heading-anchor" href="#Concentrated-mixtures">Concentrated mixtures</a><a id="Concentrated-mixtures-1"></a><a class="docs-heading-anchor-permalink" href="#Concentrated-mixtures" title="Permalink"></a></h4><p>On the other limit one finds the concentrated mixtures for which particle-particle interactions intervene on the probability distribution of motion and results obtained through <em>non-equilibrium thermodynamics</em> lead to a more complex law. Particle interactions may be simple collisions or involve more complex physics, such as electrodynamic forces; a direct solution through statistical approaches in this case quickly becomes intractable mathematically.</p><p>In what follows we will derive the diffusion equation from the aforementioned thermodynamic principles. The chemical potential is defined as the <em>sensitivity</em> of Gibbs free energy <span>$G$</span> with respect to the number of moles <span>$N$</span> of a substance. Expressed in terms of activity <span>$a$</span> we have:</p><p class="math-container">\[\mu = \dfrac{\partial{}G}{\partial{}N}=\mu^{\theta}+k_{B}T\ln(a)\]</p><p>The activity of non-ideal solutions is itself a function of a relative concentration <span>$\tilde{c}$</span> through a proportionality coefficient <span>$\gamma$</span>, the so-called activity coefficient, which by its turn can also be a function of composition. The reference concentration <span>$c_{sat}$</span> to the definition of <span>$\tilde{c}$</span> is the concentration at which a phase change happens; that said, the activity may be seen as a measure of the <em>tendency</em> towards phase change. This is all expressed as</p><p class="math-container">\[a=\gamma\tilde{c}\qquad\text{where}\qquad\tilde{c}=\dfrac{c}{c_{sat}}\]</p><p>Now let&#39;s Einstein relationship between mobility <span>$M$</span> and the diffusivity <span>$D$</span>. Mobility is defined as the capacity a given force is able to produce a net drift velocity in the system; it is related to <span>$D$</span> as</p><p class="math-container">\[M = \dfrac{\text{drift velocity}}{\text{force}} =\dfrac{D}{k_{B}T}\]</p><p>From <em>linear irreversible thermodynamics</em> (LIT) we can express the flux as</p><p class="math-container">\[\vec{F}=-Mc\nabla{}\mu=\vec{v}_{drift}c\qquad\text{where}\qquad{}\vec{v}_{drift} = -M\nabla\mu\]</p><blockquote><p>[!info] The development of (LIT) is found in <a href="../../References/@Onsager1931/">Onsager1931</a> [<a href="../../References/#Onsager1931">20</a>] and the following <a href="../../References/@Onsager1931a/">Onsager1931a</a> [<a href="../../References/#Onsager1931a">21</a>]. Notice that the above paragraph needs more grounding, it has been thrown in the text as a truth without first-principles demonstration and that is against our goals here!</p></blockquote><p>Because <span>$\log(\tilde{c})=\log(c)-\log(c_{sat})$</span> and <span>$c_{sat}$</span> is a constant, then developing <span>$\nabla\mu$</span> leads to</p><p class="math-container">\[\nabla\mu = k_{B}T\left(\dfrac{1}{c}+\dfrac{1}{\gamma}\dfrac{\partial\gamma}{\partial{}c}\right)\nabla{}c\]</p><p>Applying this result to the previous expression and reworking the terms leads to</p><p class="math-container">\[\vec{F}=-D\left(1 + \dfrac{c}{\gamma}\dfrac{\partial\gamma}{\partial{}c}\right)\nabla{}c=-D\left(1 + \dfrac{\partial\ln\gamma}{\partial\ln{}c}\right)\nabla{}c\]</p><p>Here we can identify the chemical diffusivity by comparison with Fick&#39;s law as</p><p class="math-container">\[D_{chem} = -D\left(1 + \dfrac{\partial\ln\gamma}{\partial\ln{}c}\right)\]</p><p>In the above expression, the second term in the sum is called the <em>thermodynamic factor</em>. In the limit of dilute system for which <span>$\gamma=1$</span> we fall back to <span>$D_{chem}=D$</span>, showing that the concentrated mixture approach is a proper generalization of the previous model for diluted systems.</p><h3 id="Application-to-diffusion-in-a-lattice"><a class="docs-heading-anchor" href="#Application-to-diffusion-in-a-lattice">Application to diffusion in a lattice</a><a id="Application-to-diffusion-in-a-lattice-1"></a><a class="docs-heading-anchor-permalink" href="#Application-to-diffusion-in-a-lattice" title="Permalink"></a></h3><hr/><h2 id="Fluid-mechanics"><a class="docs-heading-anchor" href="#Fluid-mechanics">Fluid mechanics</a><a id="Fluid-mechanics-1"></a><a class="docs-heading-anchor-permalink" href="#Fluid-mechanics" title="Permalink"></a></h2><h3 id="Derivation-of-continuity-equation"><a class="docs-heading-anchor" href="#Derivation-of-continuity-equation">Derivation of continuity equation</a><a id="Derivation-of-continuity-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Derivation-of-continuity-equation" title="Permalink"></a></h3><p>Moving towards a fluid mechanics application, one often needs to express the <em>continuity</em> equation for the overall mass of the system and the flowing species.</p><p>In this case, term <span>$b$</span> of previous formulation is replaced by the mass density <span>$\rho_{m}$</span> of the fluid. Flux is expressed as <span>$\vec{F}_{m}=\vec{v}_{m}\rho_{m}$</span>, where <span>$\vec{v}_{m}$</span> is the mass averaged velocity. It is useful to introduce this quantity <span>$\vec{v}_{m}$</span> because in many multi-species formulations it might become difficult to find a single velocity representing the fluid motion.</p><p>In the absence of creation rates <span>$B_{v}$</span> the continuity equation writes</p><p class="math-container">\[\frac{\partial\rho_{m}}{\partial{}t}+\nabla\cdotp\left(\rho_{m}\vec{v}_{m}\right)=0\]</p><p>For incompressible flows (constant <span>$\rho_{m}$</span>) the time derivative is by definition null and the divergent term can be expanded in terms of its components gradients as</p><p class="math-container">\[\nabla\cdotp\left(\rho_{m}\vec{v}_{m}\right)=\rho_{m}\nabla\vec{v}_{m}+\vec{v}_{m}\nabla\rho_{m}=0\]</p><p>Since <span>$\rho_{m}$</span> is constant, this simplifies to the so-called <em>incompressible fluid continuity equation</em></p><p class="math-container">\[\nabla\vec{v}_{m}=0\]</p><h3 id="Application-to-advection-diffusion-reaction"><a class="docs-heading-anchor" href="#Application-to-advection-diffusion-reaction">Application to advection-diffusion-reaction</a><a id="Application-to-advection-diffusion-reaction-1"></a><a class="docs-heading-anchor-permalink" href="#Application-to-advection-diffusion-reaction" title="Permalink"></a></h3><p>Now assume a flow where chemical species <span>$c_{i}$</span> are advected by the velocity <span>$\vec{v}_{i}$</span> and diffuse following the negative of their gradient. The flux in this case is given as <span>$F_{i} = c_{i}\vec{v}_{i}-D_{i}\nabla{}c_{i}$</span>. Applying this to the equation of conservation of <span>$c_{i}$</span> leads to</p><p class="math-container">\[\frac{\partial{}c_i}{\partial{}t}+\nabla\cdotp\left(c_{i}\vec{v}_{i}-D_{i}\nabla{}c_{i}\right)=R_{v}\]</p><p>Splitting the terms under the divergence operator in right-hand side and reorganizing:</p><p class="math-container">\[\frac{\partial{}c_i}{\partial{}t}+\nabla\cdotp\left(c_{i}\vec{v}_{i}\right)=\nabla\cdotp\left(D_{i}\nabla{}c_{i}\right)+R_{v}\]</p><p>It is often beneficial to further expand the divergence of convection term so that the equation can be reshaped as follows:</p><p class="math-container">\[\frac{D{}c_i}{D{}t}=
\frac{\partial{}c_i}{\partial{}t}+
\vec{v}_{i}\nabla{}c_{i}=
\nabla\cdotp\left(D_{i}\nabla{}c_{i}\right)-
c_{i}\nabla\cdotp\vec{v}_{i}
+R_{v}\]</p><p>In this expression the <em>big-D</em> notation represents a material or convective derivative. It provides us the behavior of transported quantity in the fluid reference frame, what can be useful for some local analysis. Even more useful than that, under this form we can promptly simplify the remaining terms in the left-hand side for cases of constant diffusivity, incompressible flow, and absence of chemical reactions (in the order of appearance of terms). For numerical solution of transport equations for incompressible flows, using the null divergent of velocity can save us a lot of trouble.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../03-Molecular-Dynamics/">« Molecular Dynamics (MD)</a><a class="docs-footer-nextpage" href="../05-Machine-Learning/">Machine Learning »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 2 July 2024 18:44">Tuesday 2 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
